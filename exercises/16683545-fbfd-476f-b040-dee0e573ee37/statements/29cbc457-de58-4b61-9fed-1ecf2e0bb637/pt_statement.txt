<p>Em uma tabela, é possível <strong>inserir valores que são obtidos diretamente do resultado de uma consulta.</strong></p><p><img alt="" src="https ://ikastaroak.birt.eus/edu/argitalpen/backupa/20200331/1920k/es/DAMDAW/BD/BD06/es_DAMDAW_BD06_Contenidos/BD06_CONT_R31_INSERT_SELECT_miniatura.png" /></p><h3>Exemplo</h3><p> Imaginemos que vamos reestruturar a empresa, para que os funcionários do departamento de <code>'Relações Públicas'</code> sejam integrados ao departamento de <code>'Vendas'</code>.</p ><p> As informações dos funcionários que foram vinculados ao departamento <code>"Relações Públicas"</code> devem ser adicionadas à tabela <code>job_history</code> antes de reatribuí-los ao <code>'Vendas '</code> departamento .</p><p>Começaremos fazendo uma consulta que busca as informações dos funcionários do departamento <code>'Relações Públicas'</code>:</p><blockquote ><pre><code>SELECT EMPLOYEES.* <br />FROM EMPLOYEES JOIN DEPARTMENTS ON (EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID)<br />WHERE DEPARTMENT_NAME = 'Relações Públicas';</code><br /><br /> employee_id | first_name | sobrenome | e-mail | número_telefone | data_contratação | job_id | salário | comissão_pct | manager_id | departamento_id <br />-------------+------------+-----------+------ -+--------------+-----------+--------+-- --------+----------------+------------+----------- ----<br /> 204 | Herman | barra | HBAER | 515.123.8888 | 1994-06-07 00:00:00 | PR_REP | 10.000,00 | | 101 | 70<br />(1 linha)</pre></blockquote><p>Em seguida, precisamos saber quais dados precisamos adicionar à tabela <code>job_history</code>, para adaptar a consulta anterior a os requisitos da tabela <code>job_history</code>:</p><blockquote><pre><code>\d job_history</code><br /><br /> Tabela "public.job_history"<br /> Coluna | Tipo | Agrupamento | Anulável | Padrão<br />---------------+----------------------------- +-----------+----------+---------<br /> funcionário_id | inteiro | | não nulo |<br /> data_inicial | timestamp sem fuso horário | | não nulo |<br /> end_date | timestamp sem fuso horário | | não nulo | <br /> job_id | caractere variando(10) | | não nulo | <br /> departamento_id | inteiro | | | </pre></blockquote><p>De todas as informações sobre os funcionários do departamento de <code>'Relações Públicas'</code>, ficamos com as seguintes informações:</p><blockquote><pre ><code >SELECT EMPLOYEE_ID, HIRE_DATE, CURRENT_DATE, JOB_ID, EMPLOYEES.DEPARTMENT_ID<br />FROM EMPLOYEES JOIN DEPARTMENTS ON (EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID)<br />WHERE DEPARTMENT_NAME = 'Relações Públicas';</code> <br / ><br /> funcionário_id | data_contratação | data_atual | job_id | departamento_id <br />-------------+---------------------+--------- --+--------+---------------<br /> 204 | 1994-06-07 00:00:00 | 31-08-2022 | PR_REP | 70<br />(1 linha)</pre></blockquote><p>Uma vez que os dados resultantes da instrução atendem aos requisitos da tabela <code>job_history</code>, podemos usar essa consulta como fonte de os dados a serem usados ​​na inserção que devemos realizar na tabela <code>job_history</code>.</p><blockquote><pre><code>BEGIN;<br /><br /> <strong> INSERT INTO job_history<br />SELECT EMPLOYEE_ID, HIRE_DATE, CURRENT_DATE, JOB_ID, EMPLOYEES.DEPARTMENT_ID<br />FROM EMPLOYEES JOIN DEPARTMENTS ON (EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID)<br />WHERE DEPARTMENT_NAME = 'Relações Públicas';< /strong><br />-- INSERT 0 1<br /><br />SELECT EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, JH.DEPARTMENT_ID<br />FROM JOB_HISTORY JH JOIN DEPARTMENTS ON (JH.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID )<br />WHERE DEPARTMENT_NAME = 'Relações Públicas';<br />ROLLBACK;</code></pre></blockquote><h3>Exercício</h3><p>Vamos criar diferentes departamentos para gerentes. Para isso, inseriremos, na tabela <code>departments</code>, um registro para cada um dos tipos de trabalho cujo identificador termine com <code>'_MAN'</code>, com os seguintes dados:< /p ><ul><li><code>DEPARTMENT_ID</code>: aquele que resulta do aumento em 300 do <code>DEPARTMENT_ID</code> do funcionário a ser nomeado gerente do departamento.</li ><li ><code>DEPARTMENT_NAME</code> - O <code>JOB_TITLE</code> do tipo de trabalho que está sendo inserido.</li><li><code>MANAGER_ID</code> - O menor identificador de funcionário entre aqueles com o tipo de trabalho que está sendo inserido.</li><li><code>LOCATION_ID</code>: o valor constante 1700</li></ul>