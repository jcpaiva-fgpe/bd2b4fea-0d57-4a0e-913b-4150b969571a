<p>Também podemos usar subconsultas para obter o valor a ser inserido em um ou mais dos atributos.</p><h3>Exemplo</h3><p>Queremos inserir um novo departamento com as seguintes características: </p><ul><li><code><strong>DEPARTMENT_ID</strong></code>: 300</li><li><code><strong>DEPARTMENT_NAME</strong>: 'JudgeLTI'< / code></li><li><code><strong>MANAGER_ID</strong></code>: Aquele que aparece como gerente do departamento cujo nome é <code>'IT'</code></ li>< li><code><strong>LOCATION_ID</strong></code>: O único endereço que aparece na cidade de <code>'Oxford'</code></li></ul><p >Nós resolveríamos com a seguinte declaração:</p><blockquote><pre><code>BEGIN;<br /><br />INSERT INTO departamentos<br />VALUES (<br /> 300, -- DEPARTMENT_ID<br /> 'JudgeLTI', -- DEPARTMENT_NAME<br /> <strong>(SELECT MANAGER_ID FROM departamentos WHERE DEPARTMENT_NAME = 'IT')</strong>, -- MANAGER_ID<br /> <strong>(SELECT LOCATION_ID FROM locais WHERE CITY = ' Oxford')</strong> -- LOC ATION_ID<br />);<br />-- INSERT 0 1<br /><br />SELECT * FROM departamentos WHERE DEPARTMENT_ID = 300;<br />ROLLBACK;<br /> departamento_id | nome_departamento | manager_id | location_id <br />---------------+-----------------+----------- --+-------------<br /> 300 | JuizLTI | 103 | 2500<br />(1 linha)</code></pre></blockquote><p>Lembre-se de que essas subconsultas exigem o retorno de valores únicos, pois só podemos atribuir um valor a cada atributo de uma linha .< /p><p>Por exemplo, se em vez da cidade de <code>'Oxford'</code>, tivéssemos escolhido o país cujo código é <code>'UK'</code>, a instrução retornaria o seguinte erro:</p><blockquote><pre><code>BEGIN;<br /><br />INSERT INTO departamentos<br />VALUES (<br /> 300, -- DEPARTMENT_ID<br /> ' JudgeLTI', -- DEPARTMENT_NAME<br /> (SELECT MANAGER_ID FROM departamentos WHERE DEPARTMENT_NAME = 'IT'), -- MANAGER_ID<br /> <strong>(SELECT LOCATION_ID FROM locais WHERE COUNTRY_ID = 'UK')</strong> - - LOCATION_ID<br />);<br />-- ERRO: mais de uma linha retornada por uma subconsulta usada como expressão<br /><br />ROLLBACK;</code></pre></blockquote > <h3>Exercício</h3><p>Imagine que você acabou de ser contratado pela empresa. Além de seu nome, sobrenomes, e-mail (sem telefone), os detalhes de sua contratação são os seguintes:</p><ul><li><code><strong>EMPLOYEE_ID</strong></code>: 220 </li><li><code><strong>HIRE_DATE</strong></code>: CURRENT_DATE</li><li><code><strong>JOB_ID</strong></code>: IT_PROG</ li ><li><code><strong>SALARY</strong></code>: você começa com o salário mínimo permitido para o trabalho <code>'IT_PROG'</code></li><li> <code><strong>DEPARTMENT_ID</strong></code>: o identificador do departamento cujo nome é <code>'IT'</code></li><li><code><strong>COMMISSION_PCT</ strong></code>: Para compensar e incentivar, você recebe a comissão máxima entre as atribuídas a qualquer funcionário.</li><li><code><strong>MANAGER_ID</strong></code>: O gerente do departamento atribuído a você.</li></ul>